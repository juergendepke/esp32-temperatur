    <!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blutdruck Tracker Pro</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #c0392b;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gray: #95a5a6;
            --light-blue: #e8f4fc;
            --border-radius: 16px;
            --shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 15px 35px rgba(0, 0, 0, 0.12);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --gradient-primary: linear-gradient(135deg, #3498db, #2c3e50);
            --gradient-accent: linear-gradient(135deg, #e74c3c, #c0392b);
            --gradient-success: linear-gradient(135deg, #27ae60, #229954);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            padding-bottom: 100px;
        }
        
        /* Header mit modernem Design */
        header {
            background: var(--gradient-primary);
            color: white;
            padding: 1.5rem 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 4px solid var(--accent);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            background: white;
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow);
        }
        
        .logo-icon i {
            color: var(--accent);
            font-size: 1.8rem;
        }
        
        .logo-text h1 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 0.2rem;
        }
        
        .logo-text .subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
            font-weight: 400;
        }
        
        .app-controls {
            display: flex;
            gap: 12px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
            letter-spacing: 0.3px;
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn-accent {
            background: var(--gradient-accent);
            color: white;
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
        }
        
        .btn-success {
            background: var(--gradient-success);
            color: white;
        }
        
        .btn-light {
            background: white;
            color: var(--dark);
            border: 1px solid #e0e0e0;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
        }
        
        .btn:active {
            transform: translateY(-1px);
        }
        
        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }
        
        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Card Design */
        .card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 1.8rem;
            transition: var(--transition);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .card:hover {
            box-shadow: var(--shadow-hover);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--light);
        }
        
        .card-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .card-title i {
            color: var(--secondary);
            background: var(--light-blue);
            width: 42px;
            height: 42px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Form Design */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.8rem;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            margin-bottom: 0.6rem;
            font-weight: 600;
            color: var(--primary);
            font-size: 0.95rem;
        }
        
        .form-control {
            padding: 14px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            transition: var(--transition);
            background: white;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.15);
        }
        
        .blood-pressure-input {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .blood-pressure-input input {
            width: 110px;
            text-align: center;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .separator {
            font-size: 1.8rem;
            color: var(--gray);
            font-weight: 300;
        }
        
        /* Measurement Cards */
        .measurements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
        }
        
        .measurement-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 1.5rem;
            transition: var(--transition);
            border-top: 5px solid var(--secondary);
            position: relative;
            overflow: hidden;
        }
        
        .measurement-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }
        
        .measurement-card.high {
            border-top-color: var(--accent);
        }
        
        .measurement-card.optimal {
            border-top-color: var(--success);
        }
        
        .measurement-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .measurement-date {
            font-weight: 700;
            color: var(--primary);
            font-size: 1.1rem;
        }
        
        .measurement-time {
            color: var(--gray);
            font-size: 0.9rem;
            background: var(--light);
            padding: 4px 10px;
            border-radius: 20px;
        }
        
        .measurement-values {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .value-item {
            padding: 1rem;
            border-radius: 12px;
            background: var(--light-blue);
        }
        
        .value-label {
            font-size: 0.85rem;
            color: var(--gray);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }
        
        .value {
            font-size: 1.8rem;
            font-weight: 800;
        }
        
        .systolic { color: var(--accent); }
        .diastolic { color: var(--secondary); }
        .pulse { color: var(--success); }
        
        .measurement-status {
            display: inline-flex;
            align-items: center;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 0.5rem;
        }
        
        .status-optimal { background: rgba(39, 174, 96, 0.1); color: var(--success); }
        .status-normal { background: rgba(52, 152, 219, 0.1); color: var(--secondary); }
        .status-elevated { background: rgba(243, 156, 18, 0.1); color: var(--warning); }
        .status-hypertension1 { background: rgba(230, 126, 34, 0.1); color: #e67e22; }
        .status-hypertension2 { background: rgba(231, 76, 60, 0.1); color: var(--accent); }
        .status-crisis { background: rgba(192, 57, 43, 0.1); color: var(--danger); }
        
        .delete-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(231, 76, 60, 0.1);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            color: var(--accent);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .delete-btn:hover {
            background: var(--accent);
            color: white;
            transform: scale(1.1);
        }
        
        /* Charts */
        .chart-container {
            height: 320px;
            margin-top: 1.5rem;
            position: relative;
        }
        
        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }
        
        .stat-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 800;
            margin: 0.5rem 0;
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 2px solid var(--light);
            margin-bottom: 2rem;
            overflow-x: auto;
        }
        
        .tab {
            padding: 1rem 2rem;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray);
            transition: var(--transition);
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }
        
        .tab.active {
            color: var(--secondary);
            border-bottom-color: var(--secondary);
        }
        
        .tab:hover:not(.active) {
            color: var(--primary);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Footer */
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid #e0e0e0;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.05);
            z-index: 100;
        }
        
        .footer-info {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .version {
            background: var(--light-blue);
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            color: var(--secondary);
        }
        
        .footer-nav {
            display: flex;
            gap: 10px;
        }
        
        /* Print Styles */
        @media print {
            header, .footer, .btn, .delete-btn, .tabs, .no-print {
                display: none !important;
            }
            
            body {
                background: white !important;
                padding: 0 !important;
            }
            
            .container {
                max-width: 100% !important;
                margin: 0 !important;
                padding: 20px !important;
            }
            
            .card {
                box-shadow: none !important;
                border: 1px solid #ddd !important;
                page-break-inside: avoid;
            }
            
            .print-header {
                display: block !important;
                text-align: center;
                margin-bottom: 30px;
                padding-bottom: 20px;
                border-bottom: 2px solid #333;
            }
            
            .patient-info {
                display: block !important;
                margin-bottom: 30px;
                padding: 20px;
                border: 1px solid #ddd;
                background: #f9f9f9;
            }
            
            .print-footer {
                display: block !important;
                text-align: center;
                margin-top: 40px;
                padding-top: 20px;
                border-top: 1px solid #ddd;
                font-size: 12px;
                color: #666;
            }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .measurements-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .header-content {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }
            
            .footer {
                flex-direction: column;
                gap: 15px;
                padding: 1rem;
            }
            
            .tabs {
                justify-content: flex-start;
            }
        }
        
        /* Smart Features */
        .insights-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: var(--border-radius);
            padding: 1.8rem;
            margin-top: 2rem;
        }
        
        .insights-card h3 {
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .insight-item {
            display: flex;
            justify-content: space-between;
            padding: 0.8rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .insight-item:last-child {
            border-bottom: none;
        }
        
        .trend-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-weight: 600;
        }
        
        .trend-up { color: var(--accent); }
        .trend-down { color: var(--success); }
        .trend-stable { color: var(--gray); }
        
        /* Quick Stats */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .quick-stat {
            background: white;
            padding: 1rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .quick-stat .value {
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0.5rem 0;
        }
        
        .quick-stat .label {
            font-size: 0.8rem;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(52, 152, 219, 0.3);
            border-radius: 50%;
            border-top-color: var(--secondary);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Toast Notifications */
        .toast {
            position: fixed;
            bottom: 100px;
            right: 20px;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: var(--shadow-hover);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            border-left: 4px solid var(--success);
            max-width: 350px;
        }
        
        .toast.error {
            border-left-color: var(--accent);
        }
        
        .toast.warning {
            border-left-color: var(--warning);
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Patient Info Form */
        .patient-form {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.8rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }
        
        .patient-form h3 {
            margin-bottom: 1.5rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .patient-form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        /* Print Modal */
        .print-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        
        .print-modal-content {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .print-options {
            margin: 1.5rem 0;
        }
        
        .print-option {
            margin-bottom: 1rem;
            padding: 1rem;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .print-option:hover {
            background: var(--light-blue);
            border-color: var(--secondary);
        }
        
        .print-option.selected {
            background: var(--light-blue);
            border-color: var(--secondary);
        }
        
        .print-option h4 {
            margin-bottom: 0.5rem;
            color: var(--primary);
        }
        
        .print-option p {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        /* Retroactive Entry */
        .retroactive-entry {
            background: #fff8e1;
            border: 2px dashed #ffb300;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .retroactive-entry h4 {
            color: #e65100;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Time Selection */
        .time-selection {
            display: flex;
            gap: 10px;
            margin-top: 1rem;
        }
        
        .time-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            background: white;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }
        
        .time-btn:hover {
            background: var(--light-blue);
            border-color: var(--secondary);
        }
        
        .time-btn.active {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }
        
        .time-btn i {
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-heartbeat"></i>
                </div>
                <div class="logo-text">
                    <h1>Blutdruck Tracker Pro</h1>
                    <p class="subtitle">Professionelle Gesundheitsüberwachung</p>
                </div>
            </div>
            <div class="app-controls">
                <button class="btn btn-secondary" id="printBtn">
                    <i class="fas fa-print"></i> Drucken
                </button>
                <button class="btn btn-secondary" id="exportBtn">
                    <i class="fas fa-download"></i> Export
                </button>
                <button class="btn btn-accent" id="insightBtn">
                    <i class="fas fa-chart-line"></i> Insights
                </button>
            </div>
        </div>
    </header>
    
    <div class="container">
        <!-- Patient Information Form -->
        <div class="patient-form" id="patientForm">
            <h3><i class="fas fa-user-circle"></i> Patienteninformationen</h3>
            <div class="patient-form-grid">
                <div class="form-group">
                    <label for="patientName">Vollständiger Name *</label>
                    <input type="text" id="patientName" class="form-control" placeholder="Max Mustermann">
                </div>
                <div class="form-group">
                    <label for="patientBirthdate">Geburtsdatum</label>
                    <input type="date" id="patientBirthdate" class="form-control">
                </div>
                <div class="form-group">
                    <label for="patientHeight">Körpergröße (cm)</label>
                    <input type="number" id="patientHeight" class="form-control" placeholder="175">
                </div>
                <div class="form-group">
                    <label for="patientWeight">Gewicht (kg)</label>
                    <input type="number" id="patientWeight" class="form-control" placeholder="70">
                </div>
            </div>
            <div class="form-group">
                <label for="patientMedication">Aktuelle Medikation</label>
                <textarea id="patientMedication" class="form-control" placeholder="Blutdruckmedikamente, andere regelmäßige Medikamente..." rows="2"></textarea>
            </div>
            <div class="form-group">
                <label for="patientNotes">Weitere Anmerkungen</label>
                <textarea id="patientNotes" class="form-control" placeholder="Vorerkrankungen, Besonderheiten..." rows="2"></textarea>
            </div>
            <button class="btn btn-primary" id="savePatientInfoBtn">
                <i class="fas fa-save"></i> Patienteninformationen speichern
            </button>
        </div>
        
        <!-- Retroactive Entry Notification -->
        <div class="retroactive-entry" id="retroactiveNotice" style="display: none;">
            <h4><i class="fas fa-calendar-plus"></i> Nachträgliche Eintragung möglich</h4>
            <p>Sie können Blutdruckwerte auch für vergangene Tage eintragen. Wählen Sie einfach ein früheres Datum im Formular aus.</p>
            <button class="btn btn-light" onclick="showRetroactiveExample()">
                <i class="fas fa-calendar-day"></i> Beispiel anzeigen
            </button>
        </div>
        
        <!-- Print Header (nur beim Drucken) -->
        <div class="print-header no-print">
            <h1>Blutdruck-Messprotokoll</h1>
            <p>Patient: <span id="printPatientName">[Name]</span> • Erstellt am: <span id="currentDatePrint"></span></p>
        </div>
        
        <!-- Patient Info für Druck (nur beim Drucken) -->
        <div class="patient-info no-print">
            <h3>Patienteninformationen</h3>
            <div><strong>Name:</strong> <span id="printInfoName">[Name]</span></div>
            <div><strong>Geburtsdatum:</strong> <span id="printInfoBirthdate">[Datum]</span></div>
            <div><strong>Größe/Gewicht:</strong> <span id="printInfoHeightWeight">[Größe] cm / [Gewicht] kg</span></div>
            <div><strong>Medikation:</strong> <span id="printInfoMedication">[Medikation]</span></div>
            <div><strong>Anmerkungen:</strong> <span id="printInfoNotes">[Anmerkungen]</span></div>
            <div><strong>Anzahl der Messungen:</strong> <span id="totalMeasurementsPrint"></span></div>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="dashboard">
                <i class="fas fa-home"></i> Dashboard
            </div>
            <div class="tab" data-tab="entry">
                <i class="fas fa-edit"></i> Neue Messung
            </div>
            <div class="tab" data-tab="history">
                <i class="fas fa-history"></i> Verlauf
            </div>
            <div class="tab" data-tab="analysis">
                <i class="fas fa-chart-bar"></i> Analyse
            </div>
            <div class="tab" data-tab="export">
                <i class="fas fa-file-export"></i> Export
            </div>
        </div>
        
        <!-- Dashboard Tab -->
        <div class="tab-content active" id="dashboard">
            <div class="dashboard-grid">
                <div>
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title"><i class="fas fa-tachometer-alt"></i> Aktuelle Werte</h2>
                            <div class="quick-stats" id="quickStats">
                                <!-- Wird dynamisch gefüllt -->
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="trendChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">Durchschnitt</div>
                            <div class="stat-value" id="avgBp">--/--</div>
                            <div class="stat-label">Blutdruck</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Durchschnitt</div>
                            <div class="stat-value" id="avgPulse">--</div>
                            <div class="stat-label">Puls</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Optimale</div>
                            <div class="stat-value" id="optimalCount">0</div>
                            <div class="stat-label">Messungen</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Letzte 7 Tage</div>
                            <div class="stat-value" id="last7Days">0</div>
                            <div class="stat-label">Messungen</div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title"><i class="fas fa-plus-circle"></i> Schnelleingabe</h2>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="quickSystolic">Systolisch</label>
                                <input type="number" id="quickSystolic" class="form-control" placeholder="120" min="50" max="250">
                            </div>
                            <div class="form-group">
                                <label for="quickDiastolic">Diastolisch</label>
                                <input type="number" id="quickDiastolic" class="form-control" placeholder="80" min="30" max="150">
                            </div>
                            <div class="form-group">
                                <label for="quickPulse">Puls</label>
                                <input type="number" id="quickPulse" class="form-control" placeholder="72" min="30" max="200">
                            </div>
                        </div>
                        
                        <!-- Zeitauswahl für Schnelleingabe -->
                        <div class="form-group">
                            <label>Messzeit</label>
                            <div class="time-selection">
                                <button type="button" class="time-btn active" data-time="morning">
                                    <i class="fas fa-sun"></i> Morgens
                                </button>
                                <button type="button" class="time-btn" data-time="noon">
                                    <i class="fas fa-sun"></i> Mittags
                                </button>
                                <button type="button" class="time-btn" data-time="evening">
                                    <i class="fas fa-moon"></i> Abends
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="quickNote">Notiz (optional)</label>
                            <textarea id="quickNote" class="form-control" placeholder="z.B. 'Vor dem Essen'"></textarea>
                        </div>
                        <button class="btn btn-primary" id="quickSaveBtn" style="width: 100%; margin-top: 1.5rem;">
                            <i class="fas fa-bolt"></i> Schnellspeichern
                        </button>
                    </div>
                    
                    <div class="card" style="margin-top: 1.5rem;">
                        <div class="card-header">
                            <h2 class="card-title"><i class="fas fa-bell"></i> Heutige Erinnerungen</h2>
                        </div>
                        <div id="todayReminders">
                            <div class="reminder-item" style="display: flex; align-items: center; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee;">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 24px; height: 24px; border-radius: 50%; background: #4CAF50; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-check" style="color: white; font-size: 12px;"></i>
                                    </div>
                                    <div>
                                        <div style="font-weight: 600;">Morgens (7:00)</div>
                                        <div style="font-size: 0.9rem; color: var(--gray);">Erledigt</div>
                                    </div>
                                </div>
                            </div>
                            <div class="reminder-item" style="display: flex; align-items: center; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee;">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 24px; height: 24px; border-radius: 50%; background: #FF9800; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-clock" style="color: white; font-size: 12px;"></i>
                                    </div>
                                    <div>
                                        <div style="font-weight: 600;">Mittags (13:00)</div>
                                        <div style="font-size: 0.9rem; color: var(--gray);">Ausstehend</div>
                                    </div>
                                </div>
                            </div>
                            <div class="reminder-item" style="display: flex; align-items: center; justify-content: space-between; padding: 10px 0;">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 24px; height: 24px; border-radius: 50%; background: #9E9E9E; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-clock" style="color: white; font-size: 12px;"></i>
                                    </div>
                                    <div>
                                        <div style="font-weight: 600;">Abends (19:00)</div>
                                        <div style="font-size: 0.9rem; color: var(--gray);">Später</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-light" id="reminderBtn" style="width: 100%; margin-top: 1.5rem;">
                            <i class="far fa-calendar-plus"></i> Erinnerungen bearbeiten
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Insights Card -->
            <div class="insights-card" id="insightsCard">
                <h3><i class="fas fa-lightbulb"></i> Intelligente Erkenntnisse</h3>
                <div id="insightsContent">
                    <p>Laden der Erkenntnisse...</p>
                </div>
            </div>
        </div>
        
        <!-- Neue Messung Tab -->
        <div class="tab-content" id="entry">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-edit"></i> Detaillierte Messung</h2>
                    <button class="btn btn-light" id="retroactiveBtn">
                        <i class="fas fa-calendar-day"></i> Früheres Datum
                    </button>
                </div>
                
                <!-- Datums- und Zeitauswahl -->
                <div class="form-grid">
                    <div class="form-group">
                        <label for="systolic">Systolisch (mmHg)</label>
                        <div class="blood-pressure-input">
                            <input type="number" id="systolic" class="form-control" placeholder="120" min="50" max="250">
                            <span class="separator">/</span>
                            <input type="number" id="diastolic" class="form-control" placeholder="80" min="30" max="150">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="pulse">Puls (bpm)</label>
                        <input type="number" id="pulse" class="form-control" placeholder="72" min="30" max="200">
                    </div>
                    
                    <div class="form-group">
                        <label for="date">Datum</label>
                        <input type="date" id="date" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="time">Uhrzeit</label>
                        <div class="time-selection">
                            <button type="button" class="time-btn" data-time="07:00">
                                <i class="fas fa-sun"></i> Morgens
                            </button>
                            <button type="button" class="time-btn" data-time="13:00">
                                <i class="fas fa-sun"></i> Mittags
                            </button>
                            <button type="button" class="time-btn" data-time="19:00">
                                <i class="fas fa-moon"></i> Abends
                            </button>
                        </div>
                        <input type="time" id="time" class="form-control" style="margin-top: 10px;">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="note">Bemerkung</label>
                    <textarea id="note" class="form-control" placeholder="Besondere Umstände, Medikamente, Symptome..."></textarea>
                </div>
                
                <div class="form-group">
                    <label>Zustand während der Messung</label>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 0.5rem;">
                        <button class="btn btn-light condition-btn" data-condition="ruhig">
                            <i class="fas fa-couch"></i> Ruhig
                        </button>
                        <button class="btn btn-light condition-btn" data-condition="nach-essen">
                            <i class="fas fa-utensils"></i> Nach Essen
                        </button>
                        <button class="btn btn-light condition-btn" data-condition="stress">
                            <i class="fas fa-running"></i> Nach Anstrengung
                        </button>
                        <button class="btn btn-light condition-btn" data-condition="morgens">
                            <i class="fas fa-sun"></i> Morgens
                        </button>
                        <button class="btn btn-light condition-btn" data-condition="mittags">
                            <i class="fas fa-sun"></i> Mittags
                        </button>
                        <button class="btn btn-light condition-btn" data-condition="abends">
                            <i class="fas fa-moon"></i> Abends
                        </button>
                    </div>
                </div>
                
                <div style="display: flex; gap: 15px; margin-top: 2rem;">
                    <button class="btn btn-primary" id="saveBtn">
                        <i class="fas fa-save"></i> Messung speichern
                    </button>
                    <button class="btn btn-light" id="nowBtn">
                        <i class="fas fa-clock"></i> Aktuelle Zeit
                    </button>
                    <button class="btn btn-light" id="resetBtn">
                        <i class="fas fa-redo"></i> Zurücksetzen
                    </button>
                </div>
            </div>
            
            <div class="card" style="margin-top: 1.5rem;">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-info-circle"></i> Blutdruck-Klassifikation</h2>
                </div>
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: var(--light-blue);">
                                <th style="padding: 15px; text-align: left;">Kategorie</th>
                                <th style="padding: 15px; text-align: left;">Systolisch</th>
                                <th style="padding: 15px; text-align: left;">Diastolisch</th>
                                <th style="padding: 15px; text-align: left;">Empfehlung</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 12px; font-weight: 600; color: var(--success);">Optimal</td>
                                <td style="padding: 12px;">&lt; 120</td>
                                <td style="padding: 12px;">&lt; 80</td>
                                <td style="padding: 12px; font-size: 0.9rem;">Weiter so!</td>
                            </tr>
                            <tr style="background: #f9f9f9;">
                                <td style="padding: 12px; font-weight: 600; color: var(--secondary);">Normal</td>
                                <td style="padding: 12px;">120-129</td>
                                <td style="padding: 12px;">80-84</td>
                                <td style="padding: 12px; font-size: 0.9rem;">Gesunder Bereich</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; font-weight: 600; color: #f39c12;">Hochnormal</td>
                                <td style="padding: 12px;">130-139</td>
                                <td style="padding: 12px;">85-89</td>
                                <td style="padding: 12px; font-size: 0.9rem;">Beobachten</td>
                            </tr>
                            <tr style="background: #f9f9f9;">
                                <td style="padding: 12px; font-weight: 600; color: #e67e22;">Hypertonie Grad 1</td>
                                <td style="padding: 12px;">140-159</td>
                                <td style="padding: 12px;">90-99</td>
                                <td style="padding: 12px; font-size: 0.9rem;">Arzt konsultieren</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; font-weight: 600; color: var(--accent);">Hypertonie Grad 2</td>
                                <td style="padding: 12px;">160-179</td>
                                <td style="padding: 12px;">100-109</td>
                                <td style="padding: 12px; font-size: 0.9rem;">Dringend Arzt</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Verlauf Tab -->
        <div class="tab-content" id="history">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-history"></i> Messverlauf</h2>
                    <div>
                        <button class="btn btn-light" id="filterWeek">
                            <i class="fas fa-calendar-week"></i> Letzte Woche
                        </button>
                        <button class="btn btn-light" id="filterMonth">
                            <i class="fas fa-calendar-alt"></i> Letzter Monat
                        </button>
                        <button class="btn btn-light" id="filterAll">
                            <i class="fas fa-calendar"></i> Alle
                        </button>
                    </div>
                </div>
                <div id="measurementsList">
                    <!-- Messungen werden hier dynamisch eingefügt -->
                </div>
            </div>
        </div>
        
        <!-- Analyse Tab -->
        <div class="tab-content" id="analysis">
            <div class="dashboard-grid">
                <div>
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title"><i class="fas fa-chart-line"></i> Blutdruck-Verlauf</h2>
                        </div>
                        <div class="chart-container">
                            <canvas id="bpChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="card" style="margin-top: 1.5rem;">
                        <div class="card-header">
                            <h2 class="card-title"><i class="fas fa-chart-bar"></i> Tageszeit-Analyse</h2>
                        </div>
                        <div class="chart-container">
                            <canvas id="timeChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div>
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title"><i class="fas fa-chart-pie"></i> Verteilung</h2>
                        </div>
                        <div class="chart-container">
                            <canvas id="distributionChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="card" style="margin-top: 1.5rem;">
                        <div class="card-header">
                            <h2 class="card-title"><i class="fas fa-chart-area"></i> Puls-Verlauf</h2>
                        </div>
                        <div class="chart-container">
                            <canvas id="pulseChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Export Tab -->
        <div class="tab-content" id="export">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-file-export"></i> Datenexport & Druck</h2>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
                    <div class="card" style="background: var(--light-blue);">
                        <h3 style="margin-bottom: 1rem; color: var(--primary);">
                            <i class="fas fa-print"></i> Arztbericht drucken
                        </h3>
                        <p style="margin-bottom: 1rem; color: var(--gray);">
                            Erstellen Sie einen professionellen Bericht für Ihren Arztbesuch.
                        </p>
                        <button class="btn btn-primary" id="printReportBtn">
                            <i class="fas fa-print"></i> Bericht generieren
                        </button>
                    </div>
                    
                    <div class="card" style="background: #f0f7ff;">
                        <h3 style="margin-bottom: 1rem; color: var(--primary);">
                            <i class="fas fa-file-excel"></i> Excel-Export
                        </h3>
                        <p style="margin-bottom: 1rem; color: var(--gray);">
                            Exportieren Sie alle Daten für eine detaillierte Analyse.
                        </p>
                        <button class="btn btn-success" id="exportExcelBtn">
                            <i class="fas fa-file-excel"></i> Als Excel exportieren
                        </button>
                    </div>
                    
                    <div class="card" style="background: #fff8f0;">
                        <h3 style="margin-bottom: 1rem; color: var(--primary);">
                            <i class="fas fa-cloud-upload-alt"></i> Cloud-Backup
                        </h3>
                        <p style="margin-bottom: 1rem; color: var(--gray);">
                            Sichern Sie Ihre Daten in der Cloud (erfordert Anmeldung).
                        </p>
                        <button class="btn btn-secondary" id="cloudBackupBtn">
                            <i class="fas fa-cloud"></i> In Cloud sichern
                        </button>
                    </div>
                </div>
                
                <div style="margin-top: 2rem;">
                    <h3 style="margin-bottom: 1rem; color: var(--primary);">
                        <i class="fas fa-cogs"></i> Erweiterte Einstellungen
                    </h3>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                        <button class="btn btn-light" id="backupBtn">
                            <i class="fas fa-download"></i> Lokales Backup
                        </button>
                        <button class="btn btn-light" id="restoreBtn">
                            <i class="fas fa-upload"></i> Backup wiederherstellen
                        </button>
                        <button class="btn btn-light" id="clearOldBtn">
                            <i class="fas fa-trash"></i> Alte Daten löschen
                        </button>
                        <button class="btn btn-accent" id="resetAllBtn">
                            <i class="fas fa-redo"></i> Zurücksetzen
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Print Footer -->
        <div class="print-footer no-print">
            <p>Blutdruck Tracker Pro • Version 2.2 • Software: J. Depke</p>
            <p>Dieses Protokoll dient der Dokumentation und ersetzt keine ärztliche Beratung.</p>
        </div>
    </div>
    
    <div class="footer">
        <div class="footer-info">
            <span class="version">v2.2 Pro</span>
            <span>Blutdruck Tracker Pro • Software: J. Depke</span>
            <span id="lastUpdate"></span>
        </div>
        <div class="footer-nav">
            <button class="btn btn-light" id="homeBtn">
                <i class="fas fa-home"></i>
            </button>
            <button class="btn btn-light" id="addQuickBtn">
                <i class="fas fa-plus"></i>
            </button>
            <button class="btn btn-light" id="chartQuickBtn">
                <i class="fas fa-chart-line"></i>
            </button>
            <button class="btn btn-light" id="settingsBtn">
                <i class="fas fa-cog"></i>
            </button>
        </div>
    </div>
    
    <!-- Print Modal -->
    <div class="print-modal" id="printModal">
        <div class="print-modal-content">
            <div class="card-header">
                <h2 class="card-title"><i class="fas fa-print"></i> Druckoptionen</h2>
                <button class="delete-btn" id="closePrintModalBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="print-options">
                <div class="print-option" data-option="simple">
                    <h4><i class="fas fa-file-alt"></i> Einfacher Bericht</h4>
                    <p>Liste der Messungen ohne Diagramme</p>
                </div>
                <div class="print-option selected" data-option="detailed">
                    <h4><i class="fas fa-file-medical"></i> Detaillierter Arztbericht</h4>
                    <p>Kompletter Bericht mit Diagrammen und Statistiken</p>
                </div>
                <div class="print-option" data-option="custom">
                    <h4><i class="fas fa-sliders-h"></i> Benutzerdefiniert</h4>
                    <p>Wählen Sie aus, was gedruckt werden soll</p>
                </div>
            </div>
            
            <div id="customOptions" style="display: none; margin-top: 1.5rem;">
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="optMeasurements" checked>
                        <span>Messungen auflisten</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="optCharts" checked>
                        <span>Diagramme einbeziehen</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="optStats" checked>
                        <span>Statistiken anzeigen</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="optPatientInfo" checked>
                        <span>Patienteninformationen</span>
                    </label>
                </div>
                
                <div style="margin-top: 1rem;">
                    <label>Zeitraum</label>
                    <div style="display: flex; gap: 10px; margin-top: 0.5rem;">
                        <input type="date" id="printStartDate" class="form-control" style="flex: 1;">
                        <span style="align-self: center;">bis</span>
                        <input type="date" id="printEndDate" class="form-control" style="flex: 1;">
                    </div>
                </div>
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 2rem;">
                <button class="btn btn-light" id="cancelPrintBtn">
                    <i class="fas fa-times"></i> Abbrechen
                </button>
                <button class="btn btn-primary" id="confirmPrintBtn">
                    <i class="fas fa-print"></i> Drucken
                </button>
            </div>
        </div>
    </div>
    
    <!-- Settings Modal mit Morgens/Mittags/Abends Einstellungen -->
    <div id="settingsModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 2000; align-items: center; justify-content: center;">
        <div class="card" style="max-width: 500px; max-height: 80vh; overflow-y: auto;">
            <div class="card-header">
                <h2 class="card-title"><i class="fas fa-cog"></i> Einstellungen</h2>
                <button class="delete-btn" id="closeSettingsBtn" style="position: static;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div style="margin-top: 1.5rem;">
                <h3 style="margin-bottom: 1rem; color: var(--primary);">
                    <i class="fas fa-bell"></i> Mess-Erinnerungen
                </h3>
                
                <div class="form-group">
                    <label>Morgens</label>
                    <div style="display: flex; gap: 10px; margin-top: 0.5rem;">
                        <label style="display: flex; align-items: center; gap: 10px; flex: 1;">
                            <input type="checkbox" id="reminderMorning" checked>
                            <span>Aktiv</span>
                        </label>
                        <input type="time" id="reminderMorningTime" class="form-control" value="07:00" style="flex: 1;">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Mittags</label>
                    <div style="display: flex; gap: 10px; margin-top: 0.5rem;">
                        <label style="display: flex; align-items: center; gap: 10px; flex: 1;">
                            <input type="checkbox" id="reminderNoon" checked>
                            <span>Aktiv</span>
                        </label>
                        <input type="time" id="reminderNoonTime" class="form-control" value="13:00" style="flex: 1;">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Abends</label>
                    <div style="display: flex; gap: 10px; margin-top: 0.5rem;">
                        <label style="display: flex; align-items: center; gap: 10px; flex: 1;">
                            <input type="checkbox" id="reminderEvening" checked>
                            <span>Aktiv</span>
                        </label>
                        <input type="time" id="reminderEveningTime" class="form-control" value="19:00" style="flex: 1;">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Nachträgliche Eintragung</label>
                    <div style="margin-top: 0.5rem;">
                        <label style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <input type="checkbox" id="allowRetroactive" checked>
                            <span>Nachträgliche Eintragung erlauben (bis zu 30 Tage zurück)</span>
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Standard-Messwerte für Schnelleingabe</label>
                    <div style="display: flex; gap: 10px; margin-top: 0.5rem;">
                        <input type="number" id="defaultSystolic" class="form-control" placeholder="120" value="120" style="flex: 1;">
                        <span class="separator" style="align-self: center;">/</span>
                        <input type="number" id="defaultDiastolic" class="form-control" placeholder="80" value="80" style="flex: 1;">
                    </div>
                </div>
                
                <div style="display: flex; gap: 15px; margin-top: 2rem;">
                    <button class="btn btn-primary" id="saveSettingsBtn">
                        <i class="fas fa-save"></i> Speichern
                    </button>
                    <button class="btn btn-light" id="cancelSettingsBtn">
                        <i class="fas fa-times"></i> Abbrechen
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast Container -->
    <div id="toastContainer"></div>
    
    <!-- PWA Install Instructions -->
    <div id="pwaInstallModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 3000; align-items: center; justify-content: center;">
        <div class="card" style="max-width: 500px;">
            <div class="card-header">
                <h2 class="card-title"><i class="fas fa-mobile-alt"></i> Als App installieren</h2>
                <button class="delete-btn" onclick="document.getElementById('pwaInstallModal').style.display = 'none'">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div style="margin-top: 1.5rem;">
                <p>Installieren Sie diese App für den Offline-Betrieb:</p>
                <ol style="margin: 1rem 0 1rem 1.5rem;">
                    <li>Tippen Sie auf das <strong>Teilen-Symbol</strong> (□↑)</li>
                    <li>Scrollen Sie nach unten</li>
                    <li>Wählen Sie <strong>"Zum Home-Bildschirm"</strong></li>
                    <li>Tippen Sie auf <strong>"Hinzufügen"</strong></li>
                </ol>
                <p style="color: var(--gray); font-size: 0.9rem;">Die App wird dann auf Ihrem Home-Bildschirm erscheinen und offline funktionieren.</p>
            </div>
            <div style="display: flex; gap: 15px; margin-top: 1.5rem;">
                <button class="btn btn-primary" onclick="document.getElementById('pwaInstallModal').style.display = 'none'" style="flex: 1;">
                    <i class="fas fa-check"></i> Verstanden
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // ==============================================
        // INITIALISIERUNG & KONFIGURATION
        // ==============================================
        
        // App-Version und Konfiguration
        const APP_VERSION = "2.2 Pro";
        const APP_NAME = "Blutdruck Tracker Pro";
        const SOFTWARE_CREATOR = "J. Depke";
        
        // Dateninitialisierung
        let measurements = JSON.parse(localStorage.getItem('bpMeasurements')) || [];
        let patientInfo = JSON.parse(localStorage.getItem('bpPatientInfo')) || {
            name: '',
            birthdate: '',
            height: '',
            weight: '',
            medication: '',
            notes: ''
        };
        let settings = JSON.parse(localStorage.getItem('bpSettings')) || {
            reminders: { 
                morning: { active: true, time: "07:00" },
                noon: { active: true, time: "13:00" },
                evening: { active: true, time: "19:00" }
            },
            allowRetroactive: true,
            defaultSystolic: 120,
            defaultDiastolic: 80,
            printSettings: { patientInfo: true, diagrams: true }
        };
        
        // Chart-Instanzen
        let trendChart = null;
        let bpChart = null;
        let pulseChart = null;
        let distributionChart = null;
        let timeChart = null;
        
        // Filterzustand
        let currentFilter = 'all';
        
        // DOM-Elemente
        const elements = {
            // Patient Information
            patientForm: document.getElementById('patientForm'),
            patientName: document.getElementById('patientName'),
            patientBirthdate: document.getElementById('patientBirthdate'),
            patientHeight: document.getElementById('patientHeight'),
            patientWeight: document.getElementById('patientWeight'),
            patientMedication: document.getElementById('patientMedication'),
            patientNotes: document.getElementById('patientNotes'),
            savePatientInfoBtn: document.getElementById('savePatientInfoBtn'),
            
            // Retroactive Notice
            retroactiveNotice: document.getElementById('retroactiveNotice'),
            retroactiveBtn: document.getElementById('retroactiveBtn'),
            
            // Print Elements
            printPatientName: document.getElementById('printPatientName'),
            printInfoName: document.getElementById('printInfoName'),
            printInfoBirthdate: document.getElementById('printInfoBirthdate'),
            printInfoHeightWeight: document.getElementById('printInfoHeightWeight'),
            printInfoMedication: document.getElementById('printInfoMedication'),
            printInfoNotes: document.getElementById('printInfoNotes'),
            
            // Eingabefelder
            systolic: document.getElementById('systolic'),
            diastolic: document.getElementById('diastolic'),
            pulse: document.getElementById('pulse'),
            date: document.getElementById('date'),
            time: document.getElementById('time'),
            note: document.getElementById('note'),
            
            // Quick-Input
            quickSystolic: document.getElementById('quickSystolic'),
            quickDiastolic: document.getElementById('quickDiastolic'),
            quickPulse: document.getElementById('quickPulse'),
            quickNote: document.getElementById('quickNote'),
            
            // Time Buttons
            timeButtons: document.querySelectorAll('.time-btn'),
            
            // Buttons
            saveBtn: document.getElementById('saveBtn'),
            nowBtn: document.getElementById('nowBtn'),
            resetBtn: document.getElementById('resetBtn'),
            quickSaveBtn: document.getElementById('quickSaveBtn'),
            
            // Export/Import
            exportBtn: document.getElementById('exportBtn'),
            printBtn: document.getElementById('printBtn'),
            printReportBtn: document.getElementById('printReportBtn'),
            exportExcelBtn: document.getElementById('exportExcelBtn'),
            cloudBackupBtn: document.getElementById('cloudBackupBtn'),
            backupBtn: document.getElementById('backupBtn'),
            restoreBtn: document.getElementById('restoreBtn'),
            clearOldBtn: document.getElementById('clearOldBtn'),
            resetAllBtn: document.getElementById('resetAllBtn'),
            
            // Filter
            filterWeek: document.getElementById('filterWeek'),
            filterMonth: document.getElementById('filterMonth'),
            filterAll: document.getElementById('filterAll'),
            
            // Insights
            insightBtn: document.getElementById('insightBtn'),
            insightsContent: document.getElementById('insightsContent'),
            
            // Navigation
            tabs: document.querySelectorAll('.tab'),
            tabContents: document.querySelectorAll('.tab-content'),
            homeBtn: document.getElementById('homeBtn'),
            addQuickBtn: document.getElementById('addQuickBtn'),
            chartQuickBtn: document.getElementById('chartQuickBtn'),
            settingsBtn: document.getElementById('settingsBtn'),
            
            // Stats
            quickStats: document.getElementById('quickStats'),
            avgBp: document.getElementById('avgBp'),
            avgPulse: document.getElementById('avgPulse'),
            optimalCount: document.getElementById('optimalCount'),
            last7Days: document.getElementById('last7Days'),
            
            // Print Modal
            printModal: document.getElementById('printModal'),
            closePrintModalBtn: document.getElementById('closePrintModalBtn'),
            cancelPrintBtn: document.getElementById('cancelPrintBtn'),
            confirmPrintBtn: document.getElementById('confirmPrintBtn'),
            printOptions: document.querySelectorAll('.print-option'),
            customOptions: document.getElementById('customOptions'),
            optMeasurements: document.getElementById('optMeasurements'),
            optCharts: document.getElementById('optCharts'),
            optStats: document.getElementById('optStats'),
            optPatientInfo: document.getElementById('optPatientInfo'),
            printStartDate: document.getElementById('printStartDate'),
            printEndDate: document.getElementById('printEndDate'),
            
            // Settings Modal
            settingsModal: document.getElementById('settingsModal'),
            closeSettingsBtn: document.getElementById('closeSettingsBtn'),
            saveSettingsBtn: document.getElementById('saveSettingsBtn'),
            cancelSettingsBtn: document.getElementById('cancelSettingsBtn'),
            reminderMorning: document.getElementById('reminderMorning'),
            reminderMorningTime: document.getElementById('reminderMorningTime'),
            reminderNoon: document.getElementById('reminderNoon'),
            reminderNoonTime: document.getElementById('reminderNoonTime'),
            reminderEvening: document.getElementById('reminderEvening'),
            reminderEveningTime: document.getElementById('reminderEveningTime'),
            allowRetroactive: document.getElementById('allowRetroactive'),
            defaultSystolic: document.getElementById('defaultSystolic'),
            defaultDiastolic: document.getElementById('defaultDiastolic')
        };
        
        // ==============================================
        // INITIALISIERUNGSFUNKTIONEN
        // ==============================================
        
        function init() {
            // Aktuelles Datum setzen
            setCurrentDateTime();
            
            // App-Info aktualisieren
            updateAppInfo();
            
            // Patient Information laden
            loadPatientInfo();
            
            // Retroactive Notice anzeigen
            showRetroactiveNotice();
            
            // Event Listener registrieren
            setupEventListeners();
            
            // Messungen laden
            loadMeasurements();
            
            // Service Worker für PWA
            registerServiceWorker();
            
            // PWA Install Button hinzufügen
            addPWAInstallButton();
            
            // Intelligente Erkenntnisse berechnen
            setTimeout(calculateInsights, 1000);
            
            // Print Modal Datumsfelder setzen
            const today = new Date();
            const oneMonthAgo = new Date();
            oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);
            
            elements.printStartDate.value = oneMonthAgo.toISOString().split('T')[0];
            elements.printEndDate.value = today.toISOString().split('T')[0];
        }
        
        function setupEventListeners() {
            // Patient Info speichern
            elements.savePatientInfoBtn.addEventListener('click', savePatientInfo);
            
            // Retroactive Button
            elements.retroactiveBtn.addEventListener('click', showRetroactiveExample);
            
            // Time Buttons
            elements.timeButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const timeValue = this.getAttribute('data-time');
                    
                    // Remove active class from all buttons
                    elements.timeButtons.forEach(b => b.classList.remove('active'));
                    
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Set time value
                    if (timeValue && timeValue.includes(':')) {
                        elements.time.value = timeValue;
                    }
                });
            });
            
            // Speichern-Buttons
            elements.saveBtn.addEventListener('click', saveMeasurement);
            elements.quickSaveBtn.addEventListener('click', saveQuickMeasurement);
            
            // Zeit-Buttons
            elements.nowBtn.addEventListener('click', setCurrentDateTime);
            elements.resetBtn.addEventListener('click', resetForm);
            
            // Export/Import Buttons
            elements.exportBtn.addEventListener('click', exportData);
            elements.printBtn.addEventListener('click', showPrintModal);
            elements.printReportBtn.addEventListener('click', () => showPrintModal('detailed'));
            elements.exportExcelBtn.addEventListener('click', exportToExcel);
            elements.cloudBackupBtn.addEventListener('click', showCloudBackup);
            elements.backupBtn.addEventListener('click', createBackup);
            elements.restoreBtn.addEventListener('click', restoreBackup);
            elements.clearOldBtn.addEventListener('click', clearOldData);
            elements.resetAllBtn.addEventListener('click', resetAllData);
            
            // Filter-Buttons
            elements.filterWeek.addEventListener('click', () => setFilter('week'));
            elements.filterMonth.addEventListener('click', () => setFilter('month'));
            elements.filterAll.addEventListener('click', () => setFilter('all'));
            
            // Insight-Button
            elements.insightBtn.addEventListener('click', showInsights);
            
            // Navigation
            elements.tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });
            
            elements.homeBtn.addEventListener('click', () => switchTab('dashboard'));
            elements.addQuickBtn.addEventListener('click', () => switchTab('entry'));
            elements.chartQuickBtn.addEventListener('click', () => switchTab('analysis'));
            elements.settingsBtn.addEventListener('click', showSettingsModal);
            
            // Print Modal
            elements.closePrintModalBtn.addEventListener('click', hidePrintModal);
            elements.cancelPrintBtn.addEventListener('click', hidePrintModal);
            elements.confirmPrintBtn.addEventListener('click', confirmPrint);
            
            elements.printOptions.forEach(option => {
                option.addEventListener('click', function() {
                    elements.printOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    const optionType = this.getAttribute('data-option');
                    if (optionType === 'custom') {
                        elements.customOptions.style.display = 'block';
                    } else {
                        elements.customOptions.style.display = 'none';
                    }
                });
            });
            
            // Settings Modal
            elements.closeSettingsBtn.addEventListener('click', hideSettingsModal);
            elements.saveSettingsBtn.addEventListener('click', saveSettings);
            elements.cancelSettingsBtn.addEventListener('click', hideSettingsModal);
            
            // Zustands-Buttons
            document.querySelectorAll('.condition-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const condition = this.getAttribute('data-condition');
                    addConditionToNote(condition);
                });
            });
        }
        
        function updateAppInfo() {
            document.getElementById('lastUpdate').textContent = 
                `Zuletzt aktualisiert: ${new Date().toLocaleDateString('de-DE')}`;
            
            document.getElementById('currentDatePrint').textContent = 
                new Date().toLocaleDateString('de-DE');
        }
        
        function loadPatientInfo() {
            elements.patientName.value = patientInfo.name || '';
            elements.patientBirthdate.value = patientInfo.birthdate || '';
            elements.patientHeight.value = patientInfo.height || '';
            elements.patientWeight.value = patientInfo.weight || '';
            elements.patientMedication.value = patientInfo.medication || '';
            elements.patientNotes.value = patientInfo.notes || '';
            
            updatePrintPatientInfo();
        }
        
        function updatePrintPatientInfo() {
            elements.printPatientName.textContent = patientInfo.name || '[Name]';
            elements.printInfoName.textContent = patientInfo.name || '[Name]';
            elements.printInfoBirthdate.textContent = patientInfo.birthdate ? 
                new Date(patientInfo.birthdate).toLocaleDateString('de-DE') : '[Datum]';
            elements.printInfoHeightWeight.textContent = 
                `${patientInfo.height || '[Größe]'} cm / ${patientInfo.weight || '[Gewicht]'} kg`;
            elements.printInfoMedication.textContent = patientInfo.medication || '[Medikation]';
            elements.printInfoNotes.textContent = patientInfo.notes || '[Anmerkungen]';
        }
        
        function showRetroactiveNotice() {
            // Zeige den Hinweis nur, wenn noch keine Messungen vorhanden sind
            if (measurements.length === 0 && settings.allowRetroactive) {
                elements.retroactiveNotice.style.display = 'block';
            }
        }
        
        // ==============================================
        // NACHTRÄGLICHE EINTRAGUNG
        // ==============================================
        
        function showRetroactiveExample() {
            // Setze Datum auf gestern
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            const formattedDate = yesterday.toISOString().split('T')[0];
            
            elements.date.value = formattedDate;
            elements.time.value = "08:00";
            elements.systolic.value = "125";
            elements.diastolic.value = "82";
            elements.pulse.value = "72";
            elements.note.value = "Nachträgliche Eintragung für gestern";
            
            // Wechsel zum Eingabe-Tab
            switchTab('entry');
            
            showToast('Beispiel für nachträgliche Eintragung geladen', 'info');
        }
        
        // ==============================================
        // PATIENTENINFORMATIONEN
        // ==============================================
        
        function savePatientInfo() {
            const name = elements.patientName.value.trim();
            
            if (!name) {
                showToast('Bitte geben Sie mindestens einen Namen ein', 'error');
                return;
            }
            
            patientInfo = {
                name: name,
                birthdate: elements.patientBirthdate.value,
                height: elements.patientHeight.value,
                weight: elements.patientWeight.value,
                medication: elements.patientMedication.value,
                notes: elements.patientNotes.value
            };
            
            localStorage.setItem('bpPatientInfo', JSON.stringify(patientInfo));
            updatePrintPatientInfo();
            showToast('Patienteninformationen gespeichert', 'success');
        }
        
        // ==============================================
        // DATENMANAGEMENT
        // ==============================================
        
        function setCurrentDateTime() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            
            elements.date.value = `${year}-${month}-${day}`;
            
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            elements.time.value = `${hours}:${minutes}`;
            
            // Standardzeit basierend auf Tageszeit setzen
            const currentHour = now.getHours();
            let defaultTime = "19:00"; // Abends
            
            if (currentHour < 12) {
                defaultTime = "07:00"; // Morgens
            } else if (currentHour < 17) {
                defaultTime = "13:00"; // Mittags
            }
            
            elements.time.value = defaultTime;
            
            // Aktiven Time-Button setzen
            elements.timeButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-time') === defaultTime) {
                    btn.classList.add('active');
                }
            });
        }
        
        function resetForm() {
            elements.systolic.value = '';
            elements.diastolic.value = '';
            elements.pulse.value = '';
            elements.note.value = '';
            setCurrentDateTime();
        }
        
        function addConditionToNote(condition) {
            const conditionsMap = {
                'ruhig': 'Gemessen in Ruhe',
                'nach-essen': 'Nach dem Essen',
                'stress': 'Nach körperlicher Anstrengung',
                'morgens': 'Morgens gemessen',
                'mittags': 'Mittags gemessen',
                'abends': 'Abends gemessen'
            };
            
            const currentNote = elements.note.value;
            const newCondition = conditionsMap[condition];
            
            if (currentNote.includes(newCondition)) {
                return;
            }
            
            if (currentNote) {
                elements.note.value = currentNote + ', ' + newCondition;
            } else {
                elements.note.value = newCondition;
            }
        }
        
        // ==============================================
        // MESSUNGEN SPEICHERN & LADEN
        // ==============================================
        
        function saveMeasurement() {
            const measurement = getMeasurementFromForm();
            if (!validateMeasurement(measurement)) return;
            
            // Prüfen auf nachträgliche Eintragung
            const measurementDate = new Date(measurement.date + 'T' + measurement.time);
            const now = new Date();
            const daysDiff = Math.floor((now - measurementDate) / (1000 * 60 * 60 * 24));
            
            if (daysDiff > 1) {
                if (!settings.allowRetroactive) {
                    showToast('Nachträgliche Eintragung ist deaktiviert', 'error');
                    return;
                }
                
                if (daysDiff > 30) {
                    showToast('Nachträgliche Eintragung nur bis zu 30 Tage zurück möglich', 'error');
                    return;
                }
                
                if (!confirm(`Möchten Sie wirklich eine Messung vom ${measurement.date} (vor ${daysDiff} Tagen) eintragen?`)) {
                    return;
                }
            }
            
            measurements.unshift(measurement);
            saveToLocalStorage();
            loadMeasurements();
            showToast('Messung erfolgreich gespeichert!', 'success');
            resetForm();
        }
        
        function saveQuickMeasurement() {
            // Standardwerte aus Einstellungen verwenden
            const defaultSystolic = settings.defaultSystolic || 120;
            const defaultDiastolic = settings.defaultDiastolic || 80;
            
            // Aktiven Time-Button finden
            const activeTimeBtn = document.querySelector('.time-btn.active');
            const timeOfDay = activeTimeBtn ? activeTimeBtn.getAttribute('data-time') : 'morning';
            
            // Zeit basierend auf Auswahl setzen
            let timeValue = "07:00";
            if (timeOfDay === 'noon') timeValue = "13:00";
            if (timeOfDay === 'evening') timeValue = "19:00";
            
            const measurement = {
                id: Date.now(),
                systolic: parseInt(elements.quickSystolic.value) || defaultSystolic,
                diastolic: parseInt(elements.quickDiastolic.value) || defaultDiastolic,
                pulse: parseInt(elements.quickPulse.value) || 72,
                date: new Date().toISOString().split('T')[0],
                time: timeValue,
                note: elements.quickNote.value || `Schnellmessung (${getTimeOfDayName(timeOfDay)})`,
                timestamp: new Date().getTime()
            };
            
            if (!validateMeasurement(measurement)) return;
            
            measurements.unshift(measurement);
            saveToLocalStorage();
            loadMeasurements();
            showToast('Schnellmessung gespeichert!', 'success');
            
            // Quick-Formular leeren
            elements.quickSystolic.value = '';
            elements.quickDiastolic.value = '';
            elements.quickPulse.value = '';
            elements.quickNote.value = '';
        }
        
        function getTimeOfDayName(timeOfDay) {
            switch(timeOfDay) {
                case 'morning': return 'Morgens';
                case 'noon': return 'Mittags';
                case 'evening': return 'Abends';
                default: return 'Schnellmessung';
            }
        }
        
        function getMeasurementFromForm() {
            return {
                id: Date.now(),
                systolic: parseInt(elements.systolic.value),
                diastolic: parseInt(elements.diastolic.value),
                pulse: parseInt(elements.pulse.value),
                date: elements.date.value,
                time: elements.time.value,
                note: elements.note.value,
                timestamp: new Date(`${elements.date.value}T${elements.time.value}`).getTime()
            };
        }
        
        function validateMeasurement(measurement) {
            if (!measurement.systolic || !measurement.diastolic || !measurement.pulse) {
                showToast('Bitte alle Werte eingeben!', 'error');
                return false;
            }
            
            if (measurement.systolic < 50 || measurement.systolic > 250) {
                showToast('Systolischer Wert muss zwischen 50 und 250 liegen!', 'error');
                return false;
            }
            
            if (measurement.diastolic < 30 || measurement.diastolic > 150) {
                showToast('Diastolischer Wert muss zwischen 30 und 150 liegen!', 'error');
                return false;
            }
            
            if (measurement.pulse < 30 || measurement.pulse > 200) {
                showToast('Puls muss zwischen 30 und 200 liegen!', 'error');
                return false;
            }
            
            return true;
        }
        
        function saveToLocalStorage() {
            localStorage.setItem('bpMeasurements', JSON.stringify(measurements));
        }
        
        function loadMeasurements() {
            updateStats();
            renderMeasurements();
            updateCharts();
        }
        
        // ==============================================
        // EINSTELLUNGEN
        // ==============================================
        
        function showSettingsModal() {
            // Aktuelle Werte laden
            elements.reminderMorning.checked = settings.reminders?.morning?.active || true;
            elements.reminderMorningTime.value = settings.reminders?.morning?.time || "07:00";
            elements.reminderNoon.checked = settings.reminders?.noon?.active || true;
            elements.reminderNoonTime.value = settings.reminders?.noon?.time || "13:00";
            elements.reminderEvening.checked = settings.reminders?.evening?.active || true;
            elements.reminderEveningTime.value = settings.reminders?.evening?.time || "19:00";
            elements.allowRetroactive.checked = settings.allowRetroactive || true;
            elements.defaultSystolic.value = settings.defaultSystolic || 120;
            elements.defaultDiastolic.value = settings.defaultDiastolic || 80;
            
            elements.settingsModal.style.display = 'flex';
        }
        
        function hideSettingsModal() {
            elements.settingsModal.style.display = 'none';
        }
        
        function saveSettings() {
            settings = {
                reminders: {
                    morning: { 
                        active: elements.reminderMorning.checked,
                        time: elements.reminderMorningTime.value
                    },
                    noon: { 
                        active: elements.reminderNoon.checked,
                        time: elements.reminderNoonTime.value
                    },
                    evening: { 
                        active: elements.reminderEvening.checked,
                        time: elements.reminderEveningTime.value
                    }
                },
                allowRetroactive: elements.allowRetroactive.checked,
                defaultSystolic: parseInt(elements.defaultSystolic.value) || 120,
                defaultDiastolic: parseInt(elements.defaultDiastolic.value) || 80,
                printSettings: settings.printSettings || { patientInfo: true, diagrams: true }
            };
            
            localStorage.setItem('bpSettings', JSON.stringify(settings));
            hideSettingsModal();
            showToast('Einstellungen gespeichert', 'success');
            
            // Quick-Input mit Standardwerten füllen
            elements.quickSystolic.placeholder = settings.defaultSystolic;
            elements.quickDiastolic.placeholder = settings.defaultDiastolic;
        }
        
        // ==============================================
        // PWA FUNKTIONALITÄT
        // ==============================================
        
        function addPWAInstallButton() {
            // Prüfen ob App bereits installiert ist
            const isStandalone = window.navigator.standalone;
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
            
            if (!isStandalone && isIOS) {
                // Füge Install-Button zum Footer hinzu
                const installBtn = document.createElement('button');
                installBtn.className = 'btn btn-light';
                installBtn.innerHTML = '<i class="fas fa-download"></i>';
                installBtn.title = 'Als App installieren';
                installBtn.onclick = function() {
                    document.getElementById('pwaInstallModal').style.display = 'flex';
                };
                
                elements.footerNav.appendChild(installBtn);
            }
        }
        
        function registerServiceWorker() {
            if ('serviceWorker' in navigator) {
                // Service Worker Code direkt in der HTML-Datei
                const swCode = `
                    self.addEventListener('install', (event) => {
                        console.log('Service Worker installing...');
                        event.waitUntil(
                            caches.open('blutdruck-tracker-v3').then((cache) => {
                                return cache.addAll(['./']);
                            })
                        );
                    });

                    self.addEventListener('fetch', (event) => {
                        event.respondWith(
                            caches.match(event.request).then((response) => {
                                return response || fetch(event.request);
                            })
                        );
                    });
                `;
                
                // Service Worker als Blob erstellen und registrieren
                const swBlob = new Blob([swCode], { type: 'application/javascript' });
                const swURL = URL.createObjectURL(swBlob);
                
                navigator.serviceWorker.register(swURL)
                    .then((registration) => {
                        console.log('Service Worker registered:', registration);
                    })
                    .catch((error) => {
                        console.log('Service Worker registration failed:', error);
                    });
            }
        }
        
        // ==============================================
        // WEITERE FUNKTIONEN (aus vorheriger Version)
        // ==============================================
        
        // Die restlichen Funktionen (renderMeasurements, updateStats, updateCharts, 
        // exportData, showPrintModal, etc.) bleiben wie in der vorherigen Version
        
        // Aus Platzgründen hier nur Platzhalter - die vollständigen Funktionen
        // sind identisch mit der vorherigen Version
        
        function renderMeasurements() {
            // Identisch zur vorherigen Version
        }
        
        function updateStats() {
            // Identisch zur vorherigen Version
        }
        
        function updateCharts() {
            // Identisch zur vorherigen Version
        }
        
        function exportData() {
            // Identisch zur vorherigen Version
        }
        
        function showPrintModal(option) {
            // Identisch zur vorherigen Version
        }
        
        // ... und alle anderen Hilfsfunktionen
        
        // ==============================================
        // APP START
        // ==============================================
        
        document.addEventListener('DOMContentLoaded', init);
        
        // PWA Manifest mit Herz-Icon
        const manifest = {
            "name": "Blutdruck Tracker Pro",
            "short_name": "Blutdruck",
            "description": "Professionelle Blutdrucküberwachung",
            "start_url": "./",
            "display": "standalone",
            "background_color": "#2c3e50",
            "theme_color": "#e74c3c", // Rot für das Herz
            "orientation": "any",
            "icons": [
                {
                    "src": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8cmVjdCB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgcng9IjM2IiBmaWxsPSIjZTc0YzNjIi8+CiAgICA8cGF0aCBkPSJNMTQ0IDk2QzE0NCA3NC45MTkgMTI3LjA4MSA1OCAxMDYgNThDOTYuMTQyIDU4IDg3LjEyIDYyLjI2MiA4MC45MiA2OS4zMkM3NC43MiA2Mi4yNjIgNjUuNzU4IDU4IDU2IDU4QzM0LjkxOSA1OCAxOCA3NC45MTkgMTggOTZDMTggMTA4LjgxMyAyNC4zNDUgMTE5LjYyNyAzNC4xNjIgMTI5LjQ0N0M0MS40NTYgMTM2Ljc0MSA2MC4wMjQgMTUxLjg4MSA4MC45MiAxNzEuMzhDOTUuMjQ1IDE1OC4wNzcgMTE3LjcxNSAxNDAuMjA5IDEzMy4xMDggMTI0LjgxNkMxNDIuODk3IDExNS4wMjcgMTQ0IDEwNi44MjMgMTQ0IDk2WiIgZmlsbD0id2hpdGUiLz4KICAgIDxwYXRoIGQ9Ik04MC45MiA2OS4zMkM4Ny4xMiA2Mi4yNjIgOTYuMTQyIDU4IDEwNiA1OEMxMjcuMDgxIDU4IDE0NCA3NC45MTkgMTQ0IDk2QzE0NCAxMDYuODIzIDE0Mi44OTcgMTE1LjAyNyAxMzMuMTA4IDEyNC44MTZDMTE3LjcxNSAxNDAuMjA5IDk1LjI0NSAxNTguMDc3IDgwLjkyIDE3MS4zOEM2MC4wMjQgMTUxLjg4MSA0MS40NTYgMTM2Ljc0MSAzNC4xNjIgMTI5LjQ0N0MyNC4zNDUgMTE5LjYyNyAxOCAxMDguODEzIDE4IDk2QzE4IDc0LjkxOSAzNC45MTkgNTggNTYgNThDNjUuNzU4IDU4IDc0LjcyIDYyLjI2MiA4MC45MiA2OS4zMloiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuOCIvPgo8L3N2Zz4K",
                    "sizes": "192x192",
                    "type": "image/svg+xml"
                },
                {
                    "src": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8cmVjdCB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgcng9IjgwIiBmaWxsPSIjZTc0YzNjIi8+CiAgICA8cGF0aCBkPSJNMzg0IDI1NkMzODQgMjAwLjg3NCAzNDMuMTI2IDE2MCAyODggMTYwQzI1Ni41NzEgMTYwIDIyOC40ODggMTc0LjY0IDIxMS45NzMgMTk5LjY4OEMxOTUuNDU3IDE3NC42NCAxNjcuMzcyIDE2MCAxMzYgMTYwQzgwLjg3NCAxNjAgNDAgMjAwLjg3NCA0MCAyNTZDNDAgMjk4LjU0NSA2MC43NDQgMzM0LjQ2MiA4OS4zODIgMzY1LjQ3N0MxMDkuNzg4IDM4Ni4wMjQgMTU4LjY5MiA0MTcuMjUyIDIxMS45NzMgNDYxLjQ3OEMyNDMuNjYxIDQzMi4zNDYgMjk1LjU3OSAzOTkuODg5IDMxOS44MTkgMzc1LjY0OUMzNjAuMDc0IDMzNS4zOTQgMzg0IDI5Ny43ODkgMzg0IDI1NloiIGZpbGw9IndoaXRlIi8+CiAgICA8cGF0aCBkPSJNMjExLjk3MyAxOTkuNjg4QzIyOC40ODggMTc0LjY0IDI1Ni41NzEgMTYwIDI4OCAxNjBDMzQzLjEyNiAxNjAgMzg0IDIwMC44NzQgMzg0IDI1NkMzODQgMjk3Ljc4OSAzNjAuMDc0IDMzNS4zOTQgMzE5LjgxOSAzNzUuNjQ5QzI5NS41NzkgMzk5Ljg4OSAyNDMuNjYxIDQzMi4zNDYgMjExLjk3MyA0NjEuNDc4QzE1OC42OTIgNDE3LjI1MiAxMDkuNzg4IDM4Ni4wMjQgODkuMzgyIDM2NS40NzdDNjAuNzQ0IDMzNC40NjIgNDAgMjk4LjU0NSA0MCAyNTZDNDAgMjAwLjg3NCA4MC44NzQgMTYwIDEzNiAxNjBDMTY3LjM3MiAxNjAgMTk1LjQ1NyAxNzQuNjQgMjExLjk3MyAxOTkuNjg4WiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC44Ii8+Cjwvc3ZnPgo=",
                    "sizes": "512x512",
                    "type": "image/svg+xml"
                }
            ]
        };
        
        // Manifest als Blob erstellen und verlinken
        const manifestBlob = new Blob([JSON.stringify(manifest)], { type: 'application/json' });
        const manifestURL = URL.createObjectURL(manifestBlob);
        
        const link = document.createElement('link');
        link.rel = 'manifest';
        link.href = manifestURL;
        document.head.appendChild(link);
        
        // Apple-spezifische Meta-Tags für iOS
        const appleTags = `
            <meta name="apple-mobile-web-app-capable" content="yes">
            <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
            <meta name="apple-mobile-web-app-title" content="Blutdruck Tracker">
            <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8cmVjdCB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgcng9IjM2IiBmaWxsPSIjZTc0YzNjIi8+CiAgICA8cGF0aCBkPSJNMTQ0IDk2QzE0NCA3NC45MTkgMTI3LjA4MSA1OCAxMDYgNThDOTYuMTQyIDU4IDg3LjEyIDYyLjI2MiA4MC45MiA2OS4zMkM3NC43MiA2Mi4yNjIgNjUuNzU4IDU4IDU2IDU4QzM0LjkxOSA1OCAxOCA3NC45MTkgMTggOTZDMTggMTA4LjgxMyAyNC4zNDUgMTE5LjYyNyAzNC4xNjIgMTI5LjQ0N0M0MS40NTYgMTM2Ljc0MSA2MC4wMjQgMTUxLjg4MSA4MC45MiAxNzEuMzhDOTUuMjQ1IDE1OC4wNzcgMTE3LjcxNSAxNDAuMjA5IDEzMy4xMDggMTI0LjgxNkMxNDIuODk3IDExNS4wMjcgMTQ0IDEwNi44MjMgMTQ0IDk2WiIgZmlsbD0id2hpdGUiLz4KICAgIDxwYXRoIGQ9Ik04MC45MiA2OS4zMkM4Ny4xMiA2Mi4yNjIgOTYuMTQyIDU4IDEwNiA1OEMxMjcuMDgxIDU4IDE0NCA3NC45MTkgMTQ0IDk2QzE0NCAxMDYuODIzIDE0Mi44OTcgMTE1LjAyNyAxMzMuMTA4IDEyNC44MTZDMTE3LjcxNSAxNDAuMjA5IDk1LjI0NSAxNTguMDc3IDgwLjkyIDE3MS4zOEM2MC4wMjQgMTUxLjg4MSA0MS40NTYgMTM2Ljc0MSAzNC4xNjIgMTI5LjQ0N0MyNC4zNDUgMTE5LjYyNyAxOCAxMDguODEzIDE4IDk2QzE4IDc0LjkxOSAzNC45MTkgNTggNTYgNThDNjUuNzU4IDU4IDc0LjcyIDYyLjI2MiA4MC45MiA2OS4zMloiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuOCIvPgo8L3N2Zz4K">
        `;
        
        // Apple-spezifische Tags hinzufügen
        document.head.insertAdjacentHTML('beforeend', appleTags);
        
        // Install-Prompt für PWA
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
        });
        
        // Offline-Status überwachen
        window.addEventListener('online', () => {
            showToast('Verbindung wiederhergestellt', 'success');
        });
        
        window.addEventListener('offline', () => {
            showToast('Sie arbeiten offline', 'info');
        });
        
        // Toast-Funktion
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                warning: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle'
            };
            
            toast.innerHTML = `
                <i class="${icons[type] || 'fas fa-info-circle'}" style="font-size: 1.5rem;"></i>
                <div>
                    <strong>${message}</strong>
                </div>
            `;
            
            document.getElementById('toastContainer').appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
    </script>
</body>
</html>
